<!DOCTYPE html>
<!-- saved from url=(0134)https://gensparkpublicblob.blob.core.windows.net/user-upload-image/page/toolu_01Ui7LsUDnpPc2TTE1BSwi7i/mr_bins_independent_system.html -->
<html lang="es"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mr BINS - Sistema ERP</title>
    <style data-fullcalendar=""></style><link href="./mr_bins_system_files/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="./mr_bins_system_files/all.min.css">
    <script src="./Mr BINS - Sistema ERP_files/chart.js"></script>
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .card-hover {
            transition: all 0.3s ease;
        }
        .card-hover:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            transition: all 0.3s ease;
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        .chart-container {
            position: relative;
            height: 300px;
            width: 100%;
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .metric-card {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }
        .metric-card-blue {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }
        .metric-card-green {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
        }
        .metric-card-orange {
            background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
        }
        .logo-text {
            font-size: 2rem;
            font-weight: bold;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }
    </style>
<style>
    .genspark-notice-dialog {
      display: flex;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      z-index: 10001;
      align-items: center;
      justify-content: center;
    }

    .genspark-notice-content {
      background-color: white;
      border-radius: 8px;
      max-width: 600px;
      width: 90%;
      box-sizing: border-box;
      padding: 10px 30px 30px 30px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      font-size: 16px;
    }

    .genspark-notice-title {
      color: #000;
      font-family: Arial;
      font-size: 20px;
      font-style: normal;
      font-weight: 700;
      line-height: 150%; 
    }

    .genspark-notice-list {
      margin: 24px 0;
      
      color: #606366;
      font-family: Arial;
      font-size: 14px;
      font-style: normal;
      font-weight: 400;
      line-height: 150%;
      padding-left: 12px;
    }

    .genspark-notice-list li {
      margin-bottom: 12px;
      list-style-type: disc;
    }

    .genspark-notice-list li a {
      color: #606366;
      text-decoration: underline;
    }

    .genspark-notice-checkbox {
      display: flex;
      align-items: center;
      margin-top: 20px;
      gap: 10px;

      color: #232425;

      font-family: Arial;
      font-size: 14px;
      font-style: normal;
      font-weight: 400;
      line-height: normal;
    }

    .genspark-notice-actions {
      display: flex;
      justify-content: center;
      margin-top: 20px;
    }
      
    .genspark-notice-ok {
      color: #232425;

      text-align: center;
      font-family: Arial;
      font-size: 16px;
      font-style: normal;
      font-weight: 700;
      line-height: 150%; 

      cursor: pointer;
      display: flex;
      height: 40px;
      padding: 6px 14px;
      justify-content: center;
      align-items: center;
      gap: 10px;
      align-self: stretch;
      border-radius: 8px;
      border: 1px solid #000;
      box-sizing: border-box;
      width: 100%;
    }
  </style><link href="chrome-extension://alhgpfoeiimagjlnfekdhkjlkiomcapa/js/css/inject.css" rel="stylesheet" type="text/css" data-apio="true"><link data-apio="true" rel="stylesheet" type="text/css" href="chrome-extension://alhgpfoeiimagjlnfekdhkjlkiomcapa/js/css/a_chrome-extension_inject_global_module_scss.css"><link data-apio="true" rel="stylesheet" type="text/css" href="chrome-extension://alhgpfoeiimagjlnfekdhkjlkiomcapa/js/css/a_common_components_ui_rich-text-editor_toolbar_UserSnippetsButton_module_scss-assets_ap-9b07b5.css"><link data-apio="true" rel="stylesheet" type="text/css" href="chrome-extension://alhgpfoeiimagjlnfekdhkjlkiomcapa/js/css/a_app_components_ai-email-assist_OneOffEmail_AIAssistantPanel_AIAssistantPanel_tsx-asset-cbcdef.css"><link data-apio="true" rel="stylesheet" type="text/css" href="chrome-extension://alhgpfoeiimagjlnfekdhkjlkiomcapa/js/css/a_app_actions_emailAccountActions_tsx-assets_app_actions_taskActions_ts-assets_app_compo-73fe6f.css"><link data-apio="true" rel="stylesheet" type="text/css" href="chrome-extension://alhgpfoeiimagjlnfekdhkjlkiomcapa/js/css/a_app_components_dialogs_InactiveContactStageConfigureDialog_tsx-assets_app_containers_a-57bdff.css"><link data-apio="true" rel="stylesheet" type="text/css" href="chrome-extension://alhgpfoeiimagjlnfekdhkjlkiomcapa/js/css/a_app_components_cards_CardExplorerOrganizationNewsArticleCard_module_scss-assets_app_co-4fc3e8.css"><link data-apio="true" rel="stylesheet" type="text/css" href="chrome-extension://alhgpfoeiimagjlnfekdhkjlkiomcapa/js/css/a_app_containers_activities_LogActivityTabs_module_scss-assets_chrome-extension_containe-381cfe.css"><link data-apio="true" rel="stylesheet" type="text/css" href="chrome-extension://alhgpfoeiimagjlnfekdhkjlkiomcapa/js/css/a_chrome-extension_v2_surfaces_linkedin_components_linkedin-overlay_LinkedinOverlay_tsx--70097a.css"><link data-apio="true" rel="stylesheet" type="text/css" href="chrome-extension://alhgpfoeiimagjlnfekdhkjlkiomcapa/js/css/a_chrome-extension_inject_core_components_OpenPopupButton_tsx-assets_chrome-extension_in-571c95.css"><link rel="prefetch" as="script" href="chrome-extension://alhgpfoeiimagjlnfekdhkjlkiomcapa/js/vendors-node_modules_re-resizable_lib_index_js-node_modules_lodash-es_escape_js-node_modules_-d1d867.chunk.js"><link rel="prefetch" as="script" href="chrome-extension://alhgpfoeiimagjlnfekdhkjlkiomcapa/js/assets_app_components_intent-data_IntentDataBarsContainer_tsx-assets_app_containers_dialogs_D-09a5ae.chunk.js"><link rel="prefetch" as="script" href="chrome-extension://alhgpfoeiimagjlnfekdhkjlkiomcapa/js/assets_app_actions_accountHierarchyActions_ts-assets_app_components_recommendations_WebsiteVi-1e8646.chunk.js"><link rel="prefetch" as="script" href="chrome-extension://alhgpfoeiimagjlnfekdhkjlkiomcapa/js/assets_app_components_playbooks_UserLinkedinProspectorPreferenceDialog_tsx-assets_app_compone-f8f8ca.chunk.js"><link rel="prefetch" as="script" href="chrome-extension://alhgpfoeiimagjlnfekdhkjlkiomcapa/js/assets_app_components_push-sequences_PushSequences_tsx-assets_app_containers_contacts_Contact-1744f2.chunk.js"><link rel="prefetch" as="script" href="chrome-extension://alhgpfoeiimagjlnfekdhkjlkiomcapa/js/assets_app_components_recommendations_NumberScoreDisplay_tsx-assets_app_containers_accounts_A-49884c.chunk.js"><link rel="prefetch" as="script" href="chrome-extension://alhgpfoeiimagjlnfekdhkjlkiomcapa/js/assets_app_components_personas_ManagePersonasDialog_tsx-assets_common_images_managePersona_svg.chunk.js"><link rel="prefetch" as="style" href="chrome-extension://alhgpfoeiimagjlnfekdhkjlkiomcapa/js/css/a_app_components_cards_CardExplorerGeneralInformationCard_tsx-assets_app_components_card-dee0cc.css"><link rel="prefetch" as="script" href="chrome-extension://alhgpfoeiimagjlnfekdhkjlkiomcapa/js/assets_app_components_cards_CardExplorerGeneralInformationCard_tsx-assets_app_components_card-dee0cc.chunk.js"><link rel="prefetch" as="script" href="chrome-extension://alhgpfoeiimagjlnfekdhkjlkiomcapa/js/assets_app_components_cards_CardExplorerSearchSignalsCard_tsx-assets_app_containers_mixed-com-727ae1.chunk.js"><link rel="prefetch" as="script" href="chrome-extension://alhgpfoeiimagjlnfekdhkjlkiomcapa/js/assets_app_components_ai-setup-wizard_AISetupWizardModal_tsx.chunk.js"><link rel="prefetch" as="style" href="chrome-extension://alhgpfoeiimagjlnfekdhkjlkiomcapa/js/css/a_app_components_finders_FinderExplorerSidebar_module_scss-assets_app_components_common_-778e91.css"><link rel="prefetch" as="script" href="chrome-extension://alhgpfoeiimagjlnfekdhkjlkiomcapa/js/assets_app_components_finders_FinderExplorerSidebar_module_scss-assets_app_components_common_-778e91.chunk.js"><link rel="prefetch" as="style" href="chrome-extension://alhgpfoeiimagjlnfekdhkjlkiomcapa/js/css/a_app_actions_signalActions_ts-assets_app_constants_ListViewItemConstants_ts-assets_app_-d3e715.css"><link rel="prefetch" as="script" href="chrome-extension://alhgpfoeiimagjlnfekdhkjlkiomcapa/js/assets_app_actions_signalActions_ts-assets_app_constants_ListViewItemConstants_ts-assets_app_-d3e715.chunk.js"><link rel="prefetch" as="script" href="chrome-extension://alhgpfoeiimagjlnfekdhkjlkiomcapa/js/assets_common_components_mixed-companies_MixedCompanySidebarHeader_tsx.chunk.js"><link rel="prefetch" as="script" href="chrome-extension://alhgpfoeiimagjlnfekdhkjlkiomcapa/js/assets_app_components_selectable-tables_columns_masterColumns_module_scss-assets_common_selec-b6b745.chunk.js"><link rel="prefetch" as="style" href="chrome-extension://alhgpfoeiimagjlnfekdhkjlkiomcapa/js/css/a_app_containers_prospect_ContactSidebarRenderer_tsx-assets_app_components_ai-setup-wiza-5a6fbe.css"><link rel="prefetch" as="script" href="chrome-extension://alhgpfoeiimagjlnfekdhkjlkiomcapa/js/assets_app_containers_prospect_ContactSidebarRenderer_tsx-assets_app_components_ai-setup-wiza-5a6fbe.chunk.js"><link rel="prefetch" as="script" href="chrome-extension://alhgpfoeiimagjlnfekdhkjlkiomcapa/js/assets_app_components_shell_navigationUtility_ts.chunk.js"><link rel="prefetch" as="script" href="chrome-extension://alhgpfoeiimagjlnfekdhkjlkiomcapa/js/assets_app_components_accounts_MixedCompanySidebarDisplay_tsx.chunk.js"><link rel="prefetch" as="style" href="chrome-extension://alhgpfoeiimagjlnfekdhkjlkiomcapa/js/css/a_app_components_personas_PersonaFinderPreview_tsx-assets_app_components_accounts_Accoun-92a37f.css"><link rel="prefetch" as="script" href="chrome-extension://alhgpfoeiimagjlnfekdhkjlkiomcapa/js/assets_app_components_personas_PersonaFinderPreview_tsx-assets_app_components_accounts_Accoun-92a37f.chunk.js"><link rel="prefetch" as="style" href="chrome-extension://alhgpfoeiimagjlnfekdhkjlkiomcapa/js/css/nm_assets_common_components_contacts_PhoneNumberBadge_module_scss-react-content-loa-ee8354.css"><link rel="prefetch" as="script" href="chrome-extension://alhgpfoeiimagjlnfekdhkjlkiomcapa/js/assets_common_components_contacts_PhoneNumberBadge_module_scss-node_modules_react-content-loa-ee8354.chunk.js"><link rel="prefetch" as="style" href="chrome-extension://alhgpfoeiimagjlnfekdhkjlkiomcapa/js/css/a_app_components_ai-setup-wizard_AISetupWizardModal_module_scss-assets_app_components_ai-f27c7c.css"><link rel="prefetch" as="style" href="chrome-extension://alhgpfoeiimagjlnfekdhkjlkiomcapa/js/css/a_app_components_finders_sieves_FinderPersonaSieve_tsx-assets_app_components_ai-setup-wi-98fda0.css"><link rel="prefetch" as="script" href="chrome-extension://alhgpfoeiimagjlnfekdhkjlkiomcapa/js/assets_app_components_finders_sieves_FinderPersonaSieve_tsx-assets_app_components_ai-setup-wi-98fda0.chunk.js"></head>
<body class="bg-gray-100 font-sans">
    
    <!-- Login Screen -->
    <div class="zp-open-popup-button"><div class="x_R61yl zp-10-0-5-zp-fixed"><img alt="Apollo.io" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA0MCA0MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTIxLjQ2NTUgNS4wNzE0N0wyMS40NzAzIDE1Ljk4NjNDMjEuNDcxIDE3LjcxMDYgMTkuNjM2NCAxOC44MTYyIDE4LjExMjEgMTguMDFMNy4xNjk4IDEyLjIyMjZDOC4wMDQzMyAxMC44NDkyIDkuMDUzNzcgOS42MjEwOSAxMC4yNzA0IDguNTgzMzJMMTguODUyNCAxNi41MTQ4QzE5LjMwNzEgMTYuOTM1IDIwLjAyNCAxNi40Nzk0IDE5LjgzNjcgMTUuODg5NEwxNi41MDg1IDUuNDA5MDJDMTcuNjI4OCA1LjE0MjEgMTguNzk3MiA1IDE5Ljk5ODkgNUMyMC40OTM5IDUgMjAuOTgyOSA1LjAyNDYgMjEuNDY1NSA1LjA3MTQ3WiIgZmlsbD0iI0VCRjIxMiIvPgo8cGF0aCBkPSJNMTguNDk2MyAzNC45MjUyTDE4LjQ5MTUgMjQuMDY1NEMxOC40OTA4IDIyLjM0MSAyMC4zMjU0IDIxLjIzNTUgMjEuODQ5NyAyMi4wNDE3TDMyLjc5NiAyNy44MzEyQzMxLjk1NTggMjkuMjAxIDMwLjkwMTYgMzAuNDI1MSAyOS42ODAxIDMxLjQ1ODFMMjEuMTA5NCAyMy41MzY5QzIwLjY1NDcgMjMuMTE2NyAxOS45Mzc4IDIzLjU3MjMgMjAuMTI1MSAyNC4xNjIzTDIzLjQ0MDcgMzQuNjAzMUMyMi4zMzYxIDM0Ljg2MjQgMjEuMTg0NCAzNSAyMC4wMDA1IDM1QzE5LjQ5MjkgMzUgMTguOTkwOSAzNC45NzQ2IDE4LjQ5NjMgMzQuOTI1MloiIGZpbGw9IiNFQkYyMTIiLz4KPHBhdGggZD0iTTIzLjQ5MTggMTguODk4MUwzMS40Mzk3IDEwLjI5OTFDMzAuNDAyNyA5LjA3NzY3IDI5LjE3NDQgOC4wMjM5NSAyNy44IDcuMTg1NjNMMjEuOTk2NCAxOC4xNTc4QzIxLjE5MDEgMTkuNjgyIDIyLjI5NTkgMjEuNTE2NyAyNC4wMjAzIDIxLjUxNTlMMzQuOTI0NSAyMS41MTExQzM0Ljk3NDIgMjEuMDE0MSAzNSAyMC41MTAxIDM1IDIwQzM1IDE4LjgxMzggMzQuODYxNyAxNy42NiAzNC42MDE0IDE2LjU1MzNMMjQuMTE3MiAxOS44ODIzQzIzLjUyNzIgMjAuMDY5NiAyMy4wNzE2IDE5LjM1MjggMjMuNDkxOCAxOC44OTgxWiIgZmlsbD0iI0VCRjIxMiIvPgo8cGF0aCBkPSJNNS4wNzA4MSAxOC41NDA2TDE1Ljk0MiAxOC41MzU4QzE3LjY2NjYgMTguNTM1MSAxOC43NzIyIDIwLjM2OTYgMTcuOTY1OSAyMS44OTM5TDEyLjE5MjIgMzIuODA5NUMxMC44MjMxIDMxLjk3MzIgOS41OTg5OCAzMC45MjMzIDguNTY1MTcgMjkuNzA2N0wxNi40NzA3IDIxLjE1MzZDMTYuODkwOSAyMC42OTg5IDE2LjQzNTEgMTkuOTgyIDE1Ljg0NTEgMjAuMTY5NEw1LjQwNzU0IDIzLjQ4MzZDNS4xNDE2MSAyMi4zNjU3IDUgMjEuMTk5NSA1IDIwQzUgMTkuNTA3NSA1LjAyNDQzIDE5LjAyMDcgNS4wNzA4MSAxOC41NDA2WiIgZmlsbD0iI0VCRjIxMiIvPgo8L3N2Zz4K" class="x_kJtSQ"></div></div><div id="loginScreen" class="min-h-screen gradient-bg flex items-center justify-center">
        <div class="bg-white p-8 rounded-lg shadow-2xl w-full max-w-md">
            <div class="text-center mb-8">
                <div class="logo-text mb-2">I ‚ù§Ô∏è üçÅ üçí</div>
                <h1 class="text-3xl font-bold text-gray-800">Mr BINS</h1>
                <p class="text-gray-600">Sistema ERP de Seguimiento</p>
            </div>
            
            <form id="loginForm">
                <div class="mb-6">
                    <label class="block text-gray-700 text-sm font-bold mb-2">Usuario</label>
                    <input type="text" id="username" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required="">
                </div>
                
                <div class="mb-6">
                    <label class="block text-gray-700 text-sm font-bold mb-2">Contrase√±a</label>
                    <input type="password" id="password" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required="">
                </div>
                
                <button type="submit" class="w-full btn-primary text-white font-bold py-3 px-4 rounded-md">
                    <i class="fas fa-sign-in-alt mr-2"></i>INGRESAR
                </button>
            </form>
            
            <div class="mt-6 text-sm text-gray-600">
                <p><strong>Credenciales:</strong></p>
                <p>SHUKINS: shukins2025</p>
                <p>SMAGH: smagh2025</p>
                <p>Master: master2025</p>
            </div>
        </div>
    </div>

    <!-- Main Application -->
    <div id="mainApp" class="hidden">
        <!-- Header -->
        <header class="gradient-bg text-white p-4 shadow-lg">
            <div class="container mx-auto flex justify-between items-center">
                <div class="flex items-center space-x-4">
                    <div class="logo-text">I ‚ù§Ô∏è üçÅ üçí</div>
                    <div>
                        <h1 class="text-2xl font-bold">Mr BINS</h1>
                        <p class="text-sm opacity-90">Sistema ERP de Seguimiento</p>
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <span id="currentUser" class="text-sm opacity-90"></span>
                    <button id="logoutBtn" class="bg-red-500 hover:bg-red-600 px-4 py-2 rounded-md text-sm font-medium transition-colors">
                        <i class="fas fa-sign-out-alt mr-2"></i>Cerrar Sesi√≥n
                    </button>
                </div>
            </div>
        </header>

        <!-- Navigation -->
        <nav class="bg-white shadow-md">
            <div class="container mx-auto">
                <ul class="flex space-x-8 p-4">
                    <li><a href="https://gensparkpublicblob.blob.core.windows.net/user-upload-image/page/toolu_01Ui7LsUDnpPc2TTE1BSwi7i/mr_bins_independent_system.html#" onclick="showSection(&#39;dashboard&#39;)" class="nav-link text-gray-700 hover:text-blue-600 font-medium"><i class="fas fa-tachometer-alt mr-2"></i>Dashboard</a></li>
                    <li><a href="https://gensparkpublicblob.blob.core.windows.net/user-upload-image/page/toolu_01Ui7LsUDnpPc2TTE1BSwi7i/mr_bins_independent_system.html#" onclick="showSection(&#39;movements&#39;)" class="nav-link text-gray-700 hover:text-blue-600 font-medium"><i class="fas fa-exchange-alt mr-2"></i>Movimientos</a></li>
                    <li><a href="https://gensparkpublicblob.blob.core.windows.net/user-upload-image/page/toolu_01Ui7LsUDnpPc2TTE1BSwi7i/mr_bins_independent_system.html#" onclick="showSection(&#39;reports&#39;)" class="nav-link text-gray-700 hover:text-blue-600 font-medium"><i class="fas fa-chart-bar mr-2"></i>Reportes</a></li>
                    <li><a href="https://gensparkpublicblob.blob.core.windows.net/user-upload-image/page/toolu_01Ui7LsUDnpPc2TTE1BSwi7i/mr_bins_independent_system.html#" onclick="showSection(&#39;settings&#39;)" class="nav-link text-gray-700 hover:text-blue-600 font-medium"><i class="fas fa-cog mr-2"></i>Configuraci√≥n</a></li>
                </ul>
            </div>
        </nav>

        <!-- Content Area -->
        <main class="container mx-auto p-6">
            
            <!-- Dashboard Section -->
            <div id="dashboardSection" class="section">
                <div class="mb-8">
                    <h2 class="text-3xl font-bold text-gray-800 mb-2">Dashboard</h2>
                    <p class="text-gray-600">Resumen operativo en tiempo real</p>
                </div>

                <!-- Metrics Cards -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <div class="metric-card p-6 rounded-lg shadow-lg card-hover">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm opacity-90">Total BINS</p>
                                <p class="text-2xl font-bold" id="totalBins">0</p>
                            </div>
                            <i class="fas fa-boxes text-3xl opacity-50"></i>
                        </div>
                    </div>
                    
                    <div class="metric-card-blue p-6 rounded-lg shadow-lg card-hover text-white">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm opacity-90">Stock Disponible</p>
                                <p class="text-2xl font-bold" id="availableStock">0</p>
                            </div>
                            <i class="fas fa-warehouse text-3xl opacity-50"></i>
                        </div>
                    </div>
                    
                    <div class="metric-card-green p-6 rounded-lg shadow-lg card-hover text-white">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm opacity-90">Fruta en Hidrocooler</p>
                                <p class="text-2xl font-bold" id="fruitInHidrocooler">0</p>
                            </div>
                            <i class="fas fa-apple-alt text-3xl opacity-50"></i>
                        </div>
                    </div>
                    
                    <div class="metric-card-orange p-6 rounded-lg shadow-lg card-hover text-white">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm opacity-90">BINS Despachados</p>
                                <p class="text-2xl font-bold" id="dispatchedBins">0</p>
                            </div>
                            <i class="fas fa-truck text-3xl opacity-50"></i>
                        </div>
                    </div>
                </div>

                <!-- Hidrocooler Status -->
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
                    <div class="bg-white p-6 rounded-lg shadow-lg">
                        <h3 class="text-xl font-bold text-gray-800 mb-4">üìç SHUKINS</h3>
                        <div class="space-y-2">
                            <div class="flex justify-between">
                                <span class="text-gray-600">Stock Disponible:</span>
                                <span class="font-bold" id="shukinsStock">0/400 BINS</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Fruta en Hidrocooler:</span>
                                <span class="font-bold" id="shukinsFruit">0 BINS</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Con Growers:</span>
                                <span class="font-bold" id="shukinsWithGrowers">0 BINS</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Despachados:</span>
                                <span class="font-bold" id="shukinsDispatched">0 BINS</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-white p-6 rounded-lg shadow-lg">
                        <h3 class="text-xl font-bold text-gray-800 mb-4">üìç SMAGH</h3>
                        <div class="space-y-2">
                            <div class="flex justify-between">
                                <span class="text-gray-600">Stock Disponible:</span>
                                <span class="font-bold" id="smaghStock">0/400 BINS</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Fruta en Hidrocooler:</span>
                                <span class="font-bold" id="smaghFruit">0 BINS</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Con Growers:</span>
                                <span class="font-bold" id="smaghWithGrowers">0 BINS</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Despachados:</span>
                                <span class="font-bold" id="smaghDispatched">0 BINS</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-white p-6 rounded-lg shadow-lg">
                        <h3 class="text-xl font-bold text-gray-800 mb-4">üìç REF</h3>
                        <div class="space-y-2">
                            <div class="flex justify-between">
                                <span class="text-gray-600">Stock Disponible:</span>
                                <span class="font-bold" id="refStock">0/400 BINS</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Fruta en Hidrocooler:</span>
                                <span class="font-bold" id="refFruit">0 BINS</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Despachados:</span>
                                <span class="font-bold" id="refDispatched">0 BINS</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Charts -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-lg shadow-lg">
                        <h3 class="text-xl font-bold text-gray-800 mb-4">Stock por Hidrocooler</h3>
                        <div class="chart-container">
                            <canvas id="stockChart" height="0" style="display: block; box-sizing: border-box; height: 0px; width: 0px;" width="0"></canvas>
                        </div>
                    </div>
                    
                    <div class="bg-white p-6 rounded-lg shadow-lg">
                        <h3 class="text-xl font-bold text-gray-800 mb-4">Movimientos por Tipo</h3>
                        <div class="chart-container">
                            <canvas id="movementChart" height="0" style="display: block; box-sizing: border-box; height: 0px; width: 0px;" width="0"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Movements Section -->
            <div id="movementsSection" class="section hidden">
                <div class="mb-8">
                    <h2 class="text-3xl font-bold text-gray-800 mb-2">Gesti√≥n de Movimientos</h2>
                    <p class="text-gray-600">Registro y control de movimientos de BINS</p>
                </div>

                <!-- Movement Buttons -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <button onclick="openMovementModal(&#39;reception&#39;)" class="bg-blue-500 hover:bg-blue-600 text-white p-6 rounded-lg shadow-lg card-hover">
                        <i class="fas fa-truck text-3xl mb-2"></i>
                        <h3 class="text-lg font-bold">Recepci√≥n BINS Vac√≠os</h3>
                    </button>
                    
                    <button onclick="openMovementModal(&#39;delivery&#39;)" class="bg-green-500 hover:bg-green-600 text-white p-6 rounded-lg shadow-lg card-hover">
                        <i class="fas fa-users text-3xl mb-2"></i>
                        <h3 class="text-lg font-bold">Entrega a Growers</h3>
                    </button>
                    
                    <button onclick="openMovementModal(&#39;return&#39;)" class="bg-yellow-500 hover:bg-yellow-600 text-white p-6 rounded-lg shadow-lg card-hover">
                        <i class="fas fa-apple-alt text-3xl mb-2"></i>
                        <h3 class="text-lg font-bold">Retorno BINS Llenos</h3>
                    </button>
                    
                    <button onclick="openMovementModal(&#39;dispatch&#39;)" class="bg-purple-500 hover:bg-purple-600 text-white p-6 rounded-lg shadow-lg card-hover">
                        <i class="fas fa-shipping-fast text-3xl mb-2"></i>
                        <h3 class="text-lg font-bold">Despacho a Kelowna</h3>
                    </button>
                </div>

                <!-- Recent Movements -->
                <div class="bg-white p-6 rounded-lg shadow-lg">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">Movimientos Recientes</h3>
                    <div class="overflow-x-auto">
                        <table class="w-full table-auto">
                            <thead>
                                <tr class="bg-gray-100">
                                    <th class="px-4 py-2 text-left">Fecha/Hora</th>
                                    <th class="px-4 py-2 text-left">Hidrocooler</th>
                                    <th class="px-4 py-2 text-left">Tipo</th>
                                    <th class="px-4 py-2 text-left">BINS</th>
                                    <th class="px-4 py-2 text-left">Empresa/Grower</th>
                                    <th class="px-4 py-2 text-left">Usuario</th>
                                </tr>
                            </thead>
                            <tbody id="recentMovements">
                                <!-- Recent movements will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Reports Section -->
            <div id="reportsSection" class="section hidden">
                <div class="mb-8">
                    <h2 class="text-3xl font-bold text-gray-800 mb-2">Reportes</h2>
                    <p class="text-gray-600">An√°lisis y reportes ejecutivos</p>
                </div>

                <!-- Report Buttons -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
                    <button onclick="generateReport(&#39;daily&#39;)" class="bg-indigo-500 hover:bg-indigo-600 text-white p-6 rounded-lg shadow-lg card-hover">
                        <i class="fas fa-calendar-day text-3xl mb-2"></i>
                        <h3 class="text-lg font-bold">Reporte Diario</h3>
                    </button>
                    
                    <button onclick="generateReport(&#39;executive&#39;)" class="bg-red-500 hover:bg-red-600 text-white p-6 rounded-lg shadow-lg card-hover">
                        <i class="fas fa-chart-line text-3xl mb-2"></i>
                        <h3 class="text-lg font-bold">Reporte Ejecutivo</h3>
                    </button>
                    
                    <button onclick="generateReport(&#39;whatsapp&#39;)" class="bg-green-500 hover:bg-green-600 text-white p-6 rounded-lg shadow-lg card-hover">
                        <i class="fab fa-whatsapp text-3xl mb-2"></i>
                        <h3 class="text-lg font-bold">Enviar WhatsApp</h3>
                    </button>
                </div>

                <!-- Report Output -->
                <div class="bg-white p-6 rounded-lg shadow-lg">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">Reporte Generado</h3>
                    <div id="reportOutput" class="bg-gray-100 p-4 rounded-md min-h-40 font-mono text-sm">
                        Selecciona un tipo de reporte para generar...
                    </div>
                </div>
            </div>

            <!-- Settings Section -->
            <div id="settingsSection" class="section hidden">
                <div class="mb-8">
                    <h2 class="text-3xl font-bold text-gray-800 mb-2">Configuraci√≥n</h2>
                    <p class="text-gray-600">Configuraci√≥n del sistema</p>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Google Apps Script Configuration -->
                    <div class="bg-white p-6 rounded-lg shadow-lg">
                        <h3 class="text-xl font-bold text-gray-800 mb-4">Google Apps Script</h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-gray-700 text-sm font-bold mb-2">URL del Script</label>
                                <input type="text" id="googleScriptUrl" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="https://script.google.com/macros/s/...">
                            </div>
                            <button onclick="saveGoogleScriptConfig()" class="btn-primary text-white font-bold py-2 px-4 rounded-md">
                                <i class="fas fa-save mr-2"></i>Guardar
                            </button>
                        </div>
                    </div>

                    <!-- WhatsApp Configuration -->
                    <div class="bg-white rounded-lg shadow-md p-6">
    <h3 class="text-xl font-semibold mb-4">WhatsApp (Twilio)</h3>
    
    <div class="space-y-4">
        <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Account SID</label>
            <input type="text" id="twilioAccountSid" placeholder="ACxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx" class="w-full p-2 border border-gray-300 rounded-md">
        </div>
        
        <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Auth Token</label>
            <input type="password" id="twilioAuthToken" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" class="w-full p-2 border border-gray-300 rounded-md">
        </div>
        
        <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Service SID</label>
            <input type="text" id="twilioServiceSid" placeholder="MGxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx" class="w-full p-2 border border-gray-300 rounded-md">
        </div>
        
        <!-- NUEVA SECCI√ìN DE N√öMEROS -->
        <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">N√∫meros de WhatsApp</label>
            <div id="phoneNumbersList" class="space-y-2">
                <!-- Los n√∫meros se cargar√°n aqu√≠ -->
            </div>
            <button onclick="addPhoneNumber()" class="mt-2 px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600">
                + Agregar N√∫mero
            </button>
        </div>
        
        <button onclick="saveTwilioSettings()" class="w-full bg-purple-500 text-white py-2 px-4 rounded-md hover:bg-purple-600">
            <i class="fas fa-save mr-2"></i>Guardar
        </button>
    </div>
</div>


                <!-- Test Connection -->
                <div class="bg-white p-6 rounded-lg shadow-lg mt-6">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">Pruebas de Conexi√≥n</h3>
                    <div class="space-x-4">
                        <button onclick="testGoogleSheetsConnection()" class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-md">
                            <i class="fas fa-table mr-2"></i>Probar Google Sheets
                        </button>
                        <button onclick="testWhatsAppConnection()" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-md">
                            <i class="fab fa-whatsapp mr-2"></i>Probar WhatsApp
                        </button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Movement Modal -->
    <div id="movementModal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
        <div class="bg-white p-8 rounded-lg shadow-2xl w-full max-w-md">
            <div class="flex justify-between items-center mb-6">
                <h3 id="modalTitle" class="text-2xl font-bold text-gray-800"></h3>
                <button onclick="closeMovementModal()" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <form id="movementForm">
                <div class="space-y-4">
                    <div>
                        <label class="block text-gray-700 text-sm font-bold mb-2">Hidrocooler</label>
                        <select id="modalHidrocooler" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required="">
                            <option value="">Seleccionar...</option>
                            <option value="SHUKINS">SHUKINS</option>
                            <option value="SMAGH">SMAGH</option>
                            <option value="REF">REF</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-gray-700 text-sm font-bold mb-2">Cantidad BINS</label>
                        <input type="number" id="modalBins" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required="">
                        <p class="text-sm text-gray-500 mt-1">TOTES: <span id="modalTotes">0</span></p>
                    </div>
                    
                    <div id="companyField" class="hidden">
                        <label class="block text-gray-700 text-sm font-bold mb-2">Empresa</label>
                        <input type="text" id="modalCompany" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    
                    <div id="driverField" class="hidden">
                        <label class="block text-gray-700 text-sm font-bold mb-2">Conductor</label>
                        <input type="text" id="modalDriver" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    
                    <div id="growerField" class="hidden">
                        <label class="block text-gray-700 text-sm font-bold mb-2">Grower</label>
                        <select id="modalGrower" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <option value="">Seleccionar...</option>
                        </select>
                    </div>
                    
                    <div id="varietyField" class="hidden">
                        <label class="block text-gray-700 text-sm font-bold mb-2">Variedad</label>
                        <select id="modalVariety" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <option value="">Seleccionar...</option>
                            <option value="Bing">Bing</option>
                            <option value="Lapins">Lapins</option>
                            <option value="Sweetheart">Sweetheart</option>
                            <option value="Regina">Regina</option>
                            <option value="Kordia">Kordia</option>
                            <option value="Santina">Santina</option>
                        </select>
                    </div>
                    
                    <div id="orchardField" class="hidden">
                        <label class="block text-gray-700 text-sm font-bold mb-2">Orchard</label>
                        <input type="text" id="modalOrchard" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    
                    <div id="harvestDateField" class="hidden">
                        <label class="block text-gray-700 text-sm font-bold mb-2">Fecha de Cosecha</label>
                        <input type="date" id="modalHarvestDate" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    
                    <div>
                        <label class="block text-gray-700 text-sm font-bold mb-2">Comentarios</label>
                        <textarea id="modalComments" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" rows="3"></textarea>
                    </div>
                </div>
                
                <div class="flex justify-end space-x-4 mt-6">
                    <button type="button" onclick="closeMovementModal()" class="px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-100">
                        Cancelar
                    </button>
                    <button type="submit" class="btn-primary text-white font-bold py-2 px-4 rounded-md">
                        <i class="fas fa-save mr-2"></i>Registrar
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Global variables
        let currentUser = null;
        let movementData = [];
        let stockData = {
            'SHUKINS': { available: 0, fruitInHidrocooler: 0, withGrowers: 0, dispatched: 0 },
            'SMAGH': { available: 0, fruitInHidrocooler: 0, withGrowers: 0, dispatched: 0 },
            'REF': { available: 0, fruitInHidrocooler: 0, withGrowers: 0, dispatched: 0 }
        };

        // User management
        const users = {
            'shukins2025': {
                name: 'Usuario SHUKINS',
                password: 'shukins@2025',
                role: 'hidrocooler_admin',
                hidrocoolers: ['SHUKINS', 'REF']
            },
            'smagh2025': {
                name: 'Usuario SMAGH',
                password: 'smagh@2025',
                role: 'hidrocooler_admin',
                hidrocoolers: ['SMAGH', 'REF']
            },
            'master2025': {
                name: 'Master Admin',
                password: 'master@2025',
                role: 'super_admin',
                hidrocoolers: ['SHUKINS', 'SMAGH', 'REF']
            }
        };

        // Growers data
        const growers = {
            'SHUKINS': [
                'Huerto San Carlos',
                'Frut√≠cola Los Andes',
                'Cerezas del Valle',
                'Productores Unidos',
                'Agr√≠cola Cordillera'
            ],
            'SMAGH': [
                'Cerezas Premium',
                'Huerto El Mirador',
                'Frutales del Sur',
                'Productores Elite',
                'Agr√≠cola Monta√±a'
            ],
            'REF': []
        };

        // Initialize application
        document.addEventListener('DOMContentLoaded', function() {
            // Load saved data
            loadDataFromStorage();
            
            // Set up event listeners
            document.getElementById('loginForm').addEventListener('submit', handleLogin);
            document.getElementById('logoutBtn').addEventListener('click', handleLogout);
            document.getElementById('movementForm').addEventListener('submit', handleMovementSubmit);
            document.getElementById('modalBins').addEventListener('input', updateTotesCalculation);
            
            // Initialize charts
            initializeCharts();
            
            // Check if user is already logged in
            const savedUser = localStorage.getItem('currentUser');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                showMainApp();
            }
        });

        // Authentication functions
        function handleLogin(e) {
            e.preventDefault();
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            if (users[username] && users[username].password === password) {
                currentUser = { username, ...users[username] };
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                showMainApp();
            } else {
                alert('Credenciales incorrectas');
            }
        }

        function handleLogout() {
            if (confirm('¬øEst√°s seguro de que quieres cerrar sesi√≥n?')) {
                localStorage.removeItem('currentUser');
                currentUser = null;
                showLoginScreen();
            }
        }

        function showMainApp() {
            document.getElementById('loginScreen').classList.add('hidden');
            document.getElementById('mainApp').classList.remove('hidden');
            document.getElementById('currentUser').textContent = currentUser.name;
            filterHidrocoolersByUser();
            updateDashboard();
            showSection('dashboard');
        }

        function showLoginScreen() {
            document.getElementById('loginScreen').classList.remove('hidden');
            document.getElementById('mainApp').classList.add('hidden');
            document.getElementById('username').value = '';
            document.getElementById('password').value = '';
        }

        function filterHidrocoolersByUser() {
            const hidrocoolerSelects = document.querySelectorAll('#modalHidrocooler');
            hidrocoolerSelects.forEach(select => {
                const options = select.querySelectorAll('option');
                options.forEach(option => {
                    if (option.value && !currentUser.hidrocoolers.includes(option.value)) {
                        option.style.display = 'none';
                    } else {
                        option.style.display = 'block';
                    }
                });
            });
        }

        // Section navigation
        function showSection(sectionName) {
            document.querySelectorAll('.section').forEach(section => {
                section.classList.add('hidden');
            });
            document.getElementById(sectionName + 'Section').classList.remove('hidden');
            document.getElementById(sectionName + 'Section').classList.add('fade-in');
            
            // Update navigation active state
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('text-blue-600', 'font-bold');
                link.classList.add('text-gray-700');
            });
            
            if (sectionName === 'dashboard') {
                updateDashboard();
            } else if (sectionName === 'movements') {
                updateRecentMovements();
            } else if (sectionName === 'settings') {
                loadSettings();
            }
        }

        // Movement modal functions
        function openMovementModal(type) {
            const modal = document.getElementById('movementModal');
            const modalTitle = document.getElementById('modalTitle');
            
            // Reset form
            document.getElementById('movementForm').reset();
            document.getElementById('modalTotes').textContent = '0';
            
            // Hide all optional fields
            document.querySelectorAll('#companyField, #driverField, #growerField, #varietyField, #orchardField, #harvestDateField').forEach(field => {
                field.classList.add('hidden');
            });
            
            // Show relevant fields based on movement type
            switch(type) {
                case 'reception':
                    modalTitle.textContent = 'Recepci√≥n BINS Vac√≠os';
                    document.getElementById('companyField').classList.remove('hidden');
                    document.getElementById('driverField').classList.remove('hidden');
                    break;
                case 'delivery':
                    modalTitle.textContent = 'Entrega a Growers';
                    document.getElementById('growerField').classList.remove('hidden');
                    document.getElementById('orchardField').classList.remove('hidden');
                    break;
                case 'return':
                    modalTitle.textContent = 'Retorno BINS Llenos';
                    document.getElementById('growerField').classList.remove('hidden');
                    document.getElementById('varietyField').classList.remove('hidden');
                    document.getElementById('orchardField').classList.remove('hidden');
                    document.getElementById('harvestDateField').classList.remove('hidden');
                    break;
                case 'dispatch':
                    modalTitle.textContent = 'Despacho a Kelowna';
                    document.getElementById('companyField').classList.remove('hidden');
                    document.getElementById('driverField').classList.remove('hidden');
                    break;
            }
            
            // Set movement type
            document.getElementById('movementForm').dataset.type = type;
            
            // Update grower dropdown based on selected hidrocooler
            document.getElementById('modalHidrocooler').addEventListener('change', updateGrowerDropdown);
            
            modal.classList.remove('hidden');
        }

        function closeMovementModal() {
            document.getElementById('movementModal').classList.add('hidden');
        }

        function updateTotesCalculation() {
            const bins = parseInt(document.getElementById('modalBins').value) || 0;
            document.getElementById('modalTotes').textContent = bins * 24;
        }

        function updateGrowerDropdown() {
            const hidrocooler = document.getElementById('modalHidrocooler').value;
            const growerSelect = document.getElementById('modalGrower');
            
            growerSelect.innerHTML = '<option value="">Seleccionar...</option>';
            
            if (hidrocooler && growers[hidrocooler]) {
                growers[hidrocooler].forEach(grower => {
                    const option = document.createElement('option');
                    option.value = grower;
                    option.textContent = grower;
                    growerSelect.appendChild(option);
                });
            }
        }

        function handleMovementSubmit(e) {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const type = e.target.dataset.type;
            const bins = parseInt(document.getElementById('modalBins').value);
            const totes = bins * 24;
            
            const movement = {
                id: Date.now(),
                timestamp: new Date().toISOString(),
                type: type,
                hidrocooler: document.getElementById('modalHidrocooler').value,
                bins: bins,
                totes: totes,
                company: document.getElementById('modalCompany').value,
                driver: document.getElementById('modalDriver').value,
                grower: document.getElementById('modalGrower').value,
                variety: document.getElementById('modalVariety').value,
                orchard: document.getElementById('modalOrchard').value,
                harvestDate: document.getElementById('modalHarvestDate').value,
                comments: document.getElementById('modalComments').value,
                user: currentUser.username
            };
            
            // Add to movement data
            movementData.push(movement);
            
            // Update stock
            updateStockData(movement);
            
            // Save to localStorage
            saveDataToStorage();
            
            // Send to Google Sheets
            sendToGoogleSheets(movement);
            
            // Update dashboard
            updateDashboard();
            
            // Close modal
            closeMovementModal();
            
            // Show success message
            alert('Movimiento registrado exitosamente');
        }

        function updateStockData(movement) {
            const hidrocooler = movement.hidrocooler;
            const bins = movement.bins;
            
            switch(movement.type) {
                case 'reception':
                    stockData[hidrocooler].available += bins;
                    break;
                case 'delivery':
                    stockData[hidrocooler].available -= bins;
                    stockData[hidrocooler].withGrowers += bins;
                    break;
                case 'return':
                    stockData[hidrocooler].withGrowers -= bins;
                    stockData[hidrocooler].fruitInHidrocooler += bins;
                    break;
                case 'dispatch':
                    stockData[hidrocooler].fruitInHidrocooler -= bins;
                    stockData[hidrocooler].dispatched += bins;
                    break;
            }
        }

        // Dashboard functions
        function updateDashboard() {
            // Calculate totals
            let totalBins = 0;
            let totalAvailable = 0;
            let totalFruit = 0;
            let totalDispatched = 0;
            
            Object.values(stockData).forEach(data => {
                totalBins += data.available + data.fruitInHidrocooler + data.withGrowers;
                totalAvailable += data.available;
                totalFruit += data.fruitInHidrocooler;
                totalDispatched += data.dispatched;
            });
            
            // Update metric cards
            document.getElementById('totalBins').textContent = totalBins;
            document.getElementById('availableStock').textContent = totalAvailable;
            document.getElementById('fruitInHidrocooler').textContent = totalFruit;
            document.getElementById('dispatchedBins').textContent = totalDispatched;
            
            // Update hidrocooler cards
            ['SHUKINS', 'SMAGH', 'REF'].forEach(hidrocooler => {
                const prefix = hidrocooler.toLowerCase();
                const data = stockData[hidrocooler];
                
                document.getElementById(prefix + 'Stock').textContent = `${data.available}/400 BINS`;
                document.getElementById(prefix + 'Fruit').textContent = `${data.fruitInHidrocooler} BINS`;
                document.getElementById(prefix + 'Dispatched').textContent = `${data.dispatched} BINS`;
                
                if (hidrocooler !== 'REF') {
                    document.getElementById(prefix + 'WithGrowers').textContent = `${data.withGrowers} BINS`;
                }
            });
            
            // Update charts
            updateCharts();
        }

        function updateRecentMovements() {
            const tbody = document.getElementById('recentMovements');
            tbody.innerHTML = '';
            
            // Get last 10 movements
            const recentMovements = movementData.slice(-10).reverse();
            
            recentMovements.forEach(movement => {
                const row = document.createElement('tr');
                row.className = 'border-b hover:bg-gray-50';
                
                const typeNames = {
                    'reception': 'Recepci√≥n Vac√≠os',
                    'delivery': 'Entrega a Growers',
                    'return': 'Retorno Llenos',
                    'dispatch': 'Despacho Kelowna'
                };
                
                row.innerHTML = `
                    <td class="px-4 py-2">${new Date(movement.timestamp).toLocaleString()}</td>
                    <td class="px-4 py-2">${movement.hidrocooler}</td>
                    <td class="px-4 py-2">${typeNames[movement.type]}</td>
                    <td class="px-4 py-2">${movement.bins}</td>
                    <td class="px-4 py-2">${movement.company || movement.grower || ''}</td>
                    <td class="px-4 py-2">${movement.user}</td>
                `;
                
                tbody.appendChild(row);
            });
        }

        // Chart functions
        let stockChart, movementChart;

        function initializeCharts() {
            // Stock Chart
            const stockCtx = document.getElementById('stockChart').getContext('2d');
            stockChart = new Chart(stockCtx, {
                type: 'bar',
                data: {
                    labels: ['SHUKINS', 'SMAGH', 'REF'],
                    datasets: [{
                        label: 'Stock Disponible',
                        data: [0, 0, 0],
                        backgroundColor: 'rgba(54, 162, 235, 0.8)',
                        borderColor: 'rgba(54, 162, 235, 1)',
                        borderWidth: 1
                    }, {
                        label: 'Fruta en Hidrocooler',
                        data: [0, 0, 0],
                        backgroundColor: 'rgba(255, 99, 132, 0.8)',
                        borderColor: 'rgba(255, 99, 132, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });

            // Movement Chart
            const movementCtx = document.getElementById('movementChart').getContext('2d');
            movementChart = new Chart(movementCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Recepci√≥n', 'Entrega', 'Retorno', 'Despacho'],
                    datasets: [{
                        data: [0, 0, 0, 0],
                        backgroundColor: [
                            'rgba(54, 162, 235, 0.8)',
                            'rgba(255, 206, 86, 0.8)',
                            'rgba(75, 192, 192, 0.8)',
                            'rgba(153, 102, 255, 0.8)'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false
                }
            });
        }

        function updateCharts() {
            // Update stock chart
            const stockValues = ['SHUKINS', 'SMAGH', 'REF'].map(h => stockData[h].available);
            const fruitValues = ['SHUKINS', 'SMAGH', 'REF'].map(h => stockData[h].fruitInHidrocooler);
            
            stockChart.data.datasets[0].data = stockValues;
            stockChart.data.datasets[1].data = fruitValues;
            stockChart.update();

            // Update movement chart
            const movementCounts = {
                reception: 0,
                delivery: 0,
                return: 0,
                dispatch: 0
            };
            
            movementData.forEach(movement => {
                movementCounts[movement.type]++;
            });
            
            movementChart.data.datasets[0].data = [
                movementCounts.reception,
                movementCounts.delivery,
                movementCounts.return,
                movementCounts.dispatch
            ];
            movementChart.update();
        }

        // Report functions
        function generateReport(type) {
            const reportOutput = document.getElementById('reportOutput');
            const today = new Date().toLocaleDateString();
            
            let report = '';
            
            switch(type) {
                case 'daily':
                    report = generateDailyReport(today);
                    break;
                case 'executive':
                    report = generateExecutiveReport(today);
                    break;
                case 'whatsapp':
                    report = generateWhatsAppReport(today);
                    sendWhatsAppReport(report);
                    break;
            }
            
            reportOutput.textContent = report;
        }

        function generateDailyReport(date) {
            const totalAvailable = Object.values(stockData).reduce((sum, data) => sum + data.available, 0);
            const totalFruit = Object.values(stockData).reduce((sum, data) => sum + data.fruitInHidrocooler, 0);
            const totalDispatched = Object.values(stockData).reduce((sum, data) => sum + data.dispatched, 0);
            
            return `üçí Mr BINS - DAILY REPORT - ${date}

üìä CONSOLIDATED SUMMARY:
   ü™£ Total Available Stock: ${totalAvailable}/1,200 BINS (${(totalAvailable/1200*100).toFixed(1)}%)
   üçí Total Fruit in Hidrocoolers: ${totalFruit} BINS
   üì¶ Total Dispatched: ${totalDispatched} BINS

üìà PERFORMANCE BY HIDROCOOLER:
   
   SHUKINS:
   ‚Ä¢ Available: ${stockData.SHUKINS.available}/400 BINS (${(stockData.SHUKINS.available/400*100).toFixed(1)}%)
   ‚Ä¢ Fruit Ready: ${stockData.SHUKINS.fruitInHidrocooler} BINS
   ‚Ä¢ With Growers: ${stockData.SHUKINS.withGrowers} BINS
   ‚Ä¢ Dispatched: ${stockData.SHUKINS.dispatched} BINS
   
   SMAGH:
   ‚Ä¢ Available: ${stockData.SMAGH.available}/400 BINS (${(stockData.SMAGH.available/400*100).toFixed(1)}%)
   ‚Ä¢ Fruit Ready: ${stockData.SMAGH.fruitInHidrocooler} BINS
   ‚Ä¢ With Growers: ${stockData.SMAGH.withGrowers} BINS
   ‚Ä¢ Dispatched: ${stockData.SMAGH.dispatched} BINS
   
   REF:
   ‚Ä¢ Available: ${stockData.REF.available}/400 BINS (${(stockData.REF.available/400*100).toFixed(1)}%)
   ‚Ä¢ Fruit Ready: ${stockData.REF.fruitInHidrocooler} BINS
   ‚Ä¢ Dispatched: ${stockData.REF.dispatched} BINS

üö® ALERTS:
${generateAlerts()}

üìä View details: [Google Sheet Link]`;
        }

        function generateExecutiveReport(date) {
            return `üìä EXECUTIVE REPORT - ${date}

üéØ OPERATIONAL HIGHLIGHTS:
   ‚Ä¢ Total Movements Today: ${movementData.filter(m => new Date(m.timestamp).toDateString() === new Date().toDateString()).length}
   ‚Ä¢ System Efficiency: ${calculateEfficiency()}%
   ‚Ä¢ Stock Utilization: ${calculateStockUtilization()}%

üìà PERFORMANCE METRICS:
   ‚Ä¢ SHUKINS Efficiency: ${calculateHidrocoolerEfficiency('SHUKINS')}%
   ‚Ä¢ SMAGH Efficiency: ${calculateHidrocoolerEfficiency('SMAGH')}%
   ‚Ä¢ REF Efficiency: ${calculateHidrocoolerEfficiency('REF')}%

üí° RECOMMENDATIONS:
${generateRecommendations()}`;
        }

        function generateWhatsAppReport(date) {
            return generateDailyReport(date);
        }

        function generateAlerts() {
            const alerts = [];
            
            Object.keys(stockData).forEach(hidrocooler => {
                const data = stockData[hidrocooler];
                const percentage = (data.available / 400) * 100;
                
                if (percentage < 20) {
                    alerts.push(`   ‚Ä¢ ${hidrocooler}: Low stock (${percentage.toFixed(1)}%)`);
                }
                
                if (data.fruitInHidrocooler > 200) {
                    alerts.push(`   ‚Ä¢ ${hidrocooler}: High fruit inventory (${data.fruitInHidrocooler} BINS)`);
                }
            });
            
            return alerts.length > 0 ? alerts.join('\n') : '   ‚Ä¢ No alerts';
        }

        function generateRecommendations() {
            const recommendations = [];
            
            Object.keys(stockData).forEach(hidrocooler => {
                const data = stockData[hidrocooler];
                const percentage = (data.available / 400) * 100;
                
                if (percentage < 20) {
                    recommendations.push(`   ‚Ä¢ Increase ${hidrocooler} capacity`);
                }
            });
            
            return recommendations.length > 0 ? recommendations.join('\n') : '   ‚Ä¢ System operating optimally';
        }

        function calculateEfficiency() {
            const totalMovements = movementData.length;
            const completedMovements = movementData.filter(m => m.type === 'dispatch').length;
            return totalMovements > 0 ? Math.round((completedMovements / totalMovements) * 100) : 0;
        }

        function calculateStockUtilization() {
            const totalCapacity = 1200;
            const totalUsed = Object.values(stockData).reduce((sum, data) => sum + data.available + data.fruitInHidrocooler, 0);
            return Math.round((totalUsed / totalCapacity) * 100);
        }

        function calculateHidrocoolerEfficiency(hidrocooler) {
            const hidrocoolerMovements = movementData.filter(m => m.hidrocooler === hidrocooler);
            const completed = hidrocoolerMovements.filter(m => m.type === 'dispatch').length;
            return hidrocoolerMovements.length > 0 ? Math.round((completed / hidrocoolerMovements.length) * 100) : 0;
        }

        // Settings functions
        function loadSettings() {
            document.getElementById('googleScriptUrl').value = localStorage.getItem('googleAppsScriptUrl') || '';
            document.getElementById('twilioAccountSid').value = localStorage.getItem('twilioAccountSid') || '';
            document.getElementById('twilioAuthToken').value = localStorage.getItem('twilioAuthToken') || '';
            document.getElementById('twilioServiceSid').value = localStorage.getItem('twilioServiceSid') || '';
        }

        function saveGoogleScriptConfig() {
            const url = document.getElementById('googleScriptUrl').value;
            localStorage.setItem('googleAppsScriptUrl', url);
            alert('Configuraci√≥n de Google Apps Script guardada');
        }

        function saveWhatsAppConfig() {
            localStorage.setItem('twilioAccountSid', document.getElementById('twilioAccountSid').value);
            localStorage.setItem('twilioAuthToken', document.getElementById('twilioAuthToken').value);
            localStorage.setItem('twilioServiceSid', document.getElementById('twilioServiceSid').value);
            alert('Configuraci√≥n de WhatsApp guardada');
        }

        function testGoogleSheetsConnection() {
            const url = localStorage.getItem('googleAppsScriptUrl');
            if (!url) {
                alert('Por favor configura la URL de Google Apps Script primero');
                return;
            }
            
            fetch(url)
                .then(response => response.json())
                .then(data => {
                    alert('Conexi√≥n exitosa con Google Sheets: ' + data.message);
                })
                .catch(error => {
                    alert('Error de conexi√≥n: ' + error.message);
                });
        }

        function testWhatsAppConnection() {
            alert('Funci√≥n de prueba de WhatsApp - Integraci√≥n pendiente');
        }

        // Google Sheets integration
        function sendToGoogleSheets(movement) {
            const url = localStorage.getItem('googleAppsScriptUrl');
            if (!url) {
                console.log('Google Apps Script URL not configured');
                return;
            }
            
            const movementTypeMap = {
                'reception': 'EMPTY_RECEPTION',
                'delivery': 'DELIVERY_TO_GROWER',
                'return': 'FULL_RETURN',
                'dispatch': 'DISPATCH_TO_KELOWNA'
            };
            
            const payload = {
                action: 'addMovement',
                movement: {
                    hidrocooler: movement.hidrocooler,
                    type: movementTypeMap[movement.type],
                    bins: movement.bins,
                    totes: movement.totes,
                    company: movement.company,
                    driver: movement.driver,
                    producer: movement.grower,
                    variety: movement.variety,
                    field: movement.orchard,
                    comments: movement.comments,
                    user: movement.user
                }
            };
            
            fetch(url, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(payload)
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    console.log('Movement sent to Google Sheets successfully');
                } else {
                    console.error('Error sending to Google Sheets:', data.error);
                }
            })
            .catch(error => {
                console.error('Error sending to Google Sheets:', error);
            });
        }

        function sendWhatsAppReport(report) {
            const accountSid = localStorage.getItem('twilioAccountSid');
            const authToken = localStorage.getItem('twilioAuthToken');
            const serviceSid = localStorage.getItem('twilioServiceSid');
            
            if (!accountSid || !authToken || !serviceSid) {
                alert('Por favor configura las credenciales de Twilio primero');
                return;
            }
            
            // WhatsApp integration would go here
            alert('Reporte WhatsApp generado (integraci√≥n pendiente)');
        }

        // Data persistence
        function saveDataToStorage() {
            localStorage.setItem('movementData', JSON.stringify(movementData));
            localStorage.setItem('stockData', JSON.stringify(stockData));
        }

        function loadDataFromStorage() {
            const savedMovements = localStorage.getItem('movementData');
            const savedStock = localStorage.getItem('stockData');
            
            if (savedMovements) {
                movementData = JSON.parse(savedMovements);
            }
            
            if (savedStock) {
                stockData = JSON.parse(savedStock);
            }
        }
    </script>


    <script id="html_badge_script1">
        window.__genspark_remove_badge_link = "https://www.genspark.ai/api/html_badge/" +
            "remove_badge?token=To%2FBnjzloZ3UfQdcSaYfDtzZlLvPT3b2xNImz%2FQKKwLFJmFH3JfhCm9jd4Gyo5ltjLcQxC%2BbhyU%2Bbo1v5QPYnk0vMMk6fuh6x%2BLcAhu8sxYFU0teuDxuoNi2zbrkOtwJZH7e4s2zgN8BBvDLt6XkQR2PL%2BYf8j9x6Y%2FXJvLDzuyLlNDKKS5yAGA83OzpraHYE4AtO5Q4C5LIJ10EPVJpa9BmvA3uj4np3ck7Jrlv1n2CdogghKn1%2Blrqma%2FjLE65A%2BRsTU1CTESS1feKi4i%2FtVOCcbgfYCkm7U7C9GSRM1c8JxHr9OJ8l54MjRgaHD%2BA2Lff%2B2XE27%2BiEucqO3Nwu0ky2rfvGLgsIfkAl%2FOucPZCPP2BzrYTBI0K6WjvBbg8XQyXa5njNqBwS9OmTuEQ4m2mMHG7bqyugyJeY6az8v0XBKRGprUZ8zK1nnPmb3LVKvz3%2Bn1WUttwjSbqkeW53GSd7v2Zl1TI7hx4yb6t2lR8nL9uZlm0uh9zYFbtSPPUGDLlD0%2F5Jq9joESdkopR1WsbR257SMrmJGL8xL%2Fjils%3D";
        window.__genspark_locale = "es-ES";
        window.__genspark_token = "To/BnjzloZ3UfQdcSaYfDtzZlLvPT3b2xNImz/QKKwLFJmFH3JfhCm9jd4Gyo5ltjLcQxC+bhyU+bo1v5QPYnk0vMMk6fuh6x+LcAhu8sxYFU0teuDxuoNi2zbrkOtwJZH7e4s2zgN8BBvDLt6XkQR2PL+Yf8j9x6Y/XJvLDzuyLlNDKKS5yAGA83OzpraHYE4AtO5Q4C5LIJ10EPVJpa9BmvA3uj4np3ck7Jrlv1n2CdogghKn1+lrqma/jLE65A+RsTU1CTESS1feKi4i/tVOCcbgfYCkm7U7C9GSRM1c8JxHr9OJ8l54MjRgaHD+A2Lff+2XE27+iEucqO3Nwu0ky2rfvGLgsIfkAl/OucPZCPP2BzrYTBI0K6WjvBbg8XQyXa5njNqBwS9OmTuEQ4m2mMHG7bqyugyJeY6az8v0XBKRGprUZ8zK1nnPmb3LVKvz3+n1WUttwjSbqkeW53GSd7v2Zl1TI7hx4yb6t2lR8nL9uZlm0uh9zYFbtSPPUGDLlD0/5Jq9joESdkopR1WsbR257SMrmJGL8xL/jils=";
    </script>
    
    <script id="html_notice_dialog_script" src="./Mr BINS - Sistema ERP_files/notice_dialog.js"></script>
    <div style="position: relative;" id="zp-10-0-5-licdn-root-apollo_everywhere" data-has-tooltip-listener=""><div class="x_BJJxg" data-disable-focus-trap="true"></div><div class="x_KfhZL" aria-live="polite" aria-atomic="true" data-disable-focus-trap="true"></div><span data-name="tooltip-listener" aria-hidden="true" style="display: none;"></span> </div></body></html>
